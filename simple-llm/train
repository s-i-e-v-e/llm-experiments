#!/bin/sh
export OPENBLAS_NUM_THREADS=12
BACKEND=jax
EPOCHS=10
EMBEDDING_DIM=160
CONTEXT_LENGTH=256
HEADS=8
LAYERS=6
BATCH_SIZE=16
LEARNING_RATE=0.0008
VOCAB=800
RESUME=--resume
uv run app.py train $RESUME --model-path out/$1 --backend $BACKEND --vocab-size $VOCAB --epochs $EPOCHS --embedding-dim $EMBEDDING_DIM --n-heads $HEADS --n-layers $LAYERS --batch-size $BATCH_SIZE --context-length $CONTEXT_LENGTH --learning-rate $LEARNING_RATE $2
